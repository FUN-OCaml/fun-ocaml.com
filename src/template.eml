let maybe_render_questions (questions: Data.question list) =
    if List.length questions > 0 then
        <ol class="flex flex-col gap-2 my-4">
        <% questions |> List.iter (fun (question: Data.question) -> %>
        <li class="font-semibold"><%s question.title %></li>
        <% ); %>
        </ol>
    else ""

let render (features: Data.t list) =
    <!doctype html>
    <html lang=en>
    <head>
        <meta charset=utf-8>
        <title>Roadmap</title>
        <link rel="stylesheet" href="css/main.css">
    </head>
    <body class="bg-cyan-900 py-36 font-mono">
    <div class="container mx-auto flex flex-col gap-6">
% features |> List.iter (fun (feature: Data.t) ->
    <div>
        <h1 class="text-3xl font-semibold text-white my-6"><%s feature.title %></h1>
        <p><%s feature.description |> Option.value ~default:"" %><p>
        <%s! maybe_render_questions feature.questions %>
        <div class="grid gap-10">
% feature.subfeatures |> List.iter (fun (feature: Data.t) ->
            <div class="bg-cyan-100 p-6 rounded-lg">
                <h2 class="text-2xl mb-3"><%s feature.title %></h1>
                <p><%s feature.description |> Option.value ~default:"" %><p>
                <%s! maybe_render_questions feature.questions %>
                <div class="grid gap-10">
% feature.subfeatures |> List.iter (fun (feature: Data.t) ->
                    <div class="bg-cyan-800 p-6 rounded-lg text-white">
                        <h2 class="text-2xl mb-3"><%s feature.title %></h1>
                        <p><%s feature.description |> Option.value ~default:"" %><p>
                        <%s! maybe_render_questions feature.questions %>
                    </div>
% );
                </div>
            </div>
% );
        </div>
    </div>
% );
    </div>
    </body>
    </html>
